## 📺 시연 영상

[https://youtu.be/axnqKjhl4eo](https://youtu.be/axnqKjhl4eo)


# 🚀 XRP Ledger 기반 온라인 챌린지 플랫폼

본 프로젝트는 **XRP Ledger(XRPL)의 핵심 기능**과 **Spring Modulith 기반의 이벤트 주도 아키텍처**를 결합하여, 확장 가능하고 신뢰성 높은 온라인 챌린지 플랫폼을 구축합니다. 각 기술이 어떻게 유기적으로 결합되어 비즈니스 로직을 해결하는지 4단계의 핵심 플로우를 통해 설명합니다.

---

## ✨ 핵심 플로우

### 1단계: EscrowCreate - 참가비의 조건부 예치와 신뢰 확보

사용자가 챌린지에 참여하며 참가비를 지불하는 시나리오입니다.

* **XRPL 상호작용**:
    1.  참가비는 플랫폼의 중앙 지갑으로 직접 전송되지 않고, **XRPL의 `EscrowCreate` 트랜잭션을 통해 조건부 계좌에 안전하게 예치**됩니다.
    2.  이 에스크로는 '챌린지 종료'라는 조건이 충족되어야만 자금이 해제되도록 설계되었습니다. 이는 운영 주체조차 챌린지 기간 중에는 자금을 임의로 인출할 수 없음을 의미하며, **코드 레벨에서 사용자의 자산을 보호**합니다.

* **기술적 가치**:
    * **중앙화 리스크 제거**: 플랫폼의 신뢰도를 운영 주체의 평판이 아닌, **블록체인 원장에 기록된 불변의 코드(Immutable Code)**로 증명합니다.
    * **투명성**: 모든 참가비 예치 내역은 **XRPL 원장에서 누구나 조회 가능**하여 프로세스의 투명성을 보장합니다.

---

### 2단계: ChallengeCompletedEvent - 모듈 간 결합도를 낮추는 자동화 트리거

챌린지 종료 시간이 되면, `catalog` 모듈의 `Challenge` 애그리거트에서 `ChallengeCompletedEvent`가 발행됩니다.

* **시스템 상호작용**:
    1.  `xrpl` 모듈의 `XRPLEventListener`는 `catalog` 모듈에 대한 직접적인 의존성 없이, 발행된 `ChallengeCompletedEvent`를 **비동기적으로 수신**합니다.
    2.  이 이벤트는 XRPL과의 온체인 정산 로직을 실행하는 **'트리거' 역할**을 합니다. `XRPLEventListener`는 이벤트를 받아 정산에 필요한 데이터(참여자 목록, 성공률 등)를 각 모듈의 API(`ParticipationQueryService`, `UserQueryService` 등)를 통해 조회하고 집계합니다.

* **기술적 가치**:
    * **유연한 확장성**: 이벤트 기반 통신은 각 모듈의 독립성을 보장합니다. 향후 새로운 보상 정책이나 챌린지 유형이 추가되더라도, `xrpl` 모듈의 핵심 정산 로직을 수정할 필요 없이 **새로운 이벤트 리스너를 추가하거나 기존 리스너를 확장하는 방식으로 유연하게 대응**할 수 있습니다. 이는 시스템의 유지보수성과 확장성을 극대화합니다.
    * **관심사의 분리(SoC)**: 챌린지의 상태를 관리하는 `catalog` 모듈과 블록체인 정산을 처리하는 `xrpl` 모듈의 책임이 명확하게 분리됩니다.

---

### 3단계: Batch 처리 - 대규모 트랜잭션의 효율적 실행

`XRPLEventListener`는 집계된 데이터를 바탕으로 모든 참가자의 에스크로를 정산하고, 성공 기준을 충족한 참가자에게 환급금을 지급합니다.

* **XRPL 상호작용**:
    1.  `completeBatchEscrow`: 모든 참가자의 **`EscrowFinish` 트랜잭션을 생성하여 일괄 제출**합니다.
    2.  `sendBatchPayment`: 인증 성공률 70%를 넘은 사용자들에게 환급금을 지급하기 위해 **다수의 `Payment` 트랜잭션을 생성하여 일괄 제출**합니다.
    3.  두 메서드 모두 중앙 지갑 계정의 Sequence 번호를 코드 레벨에서 직접 관리(`currentSequence.plus(UnsignedInteger.ONE)`)하며 트랜잭션을 순차적으로 제출하여 처리 효율을 극대화하고 **논스(nonce) 충돌을 방지**합니다.

* **기술적 가치**:
    * **운영 자동화**: 수백, 수천 건의 정산 및 환급 트랜잭션을 수동 개입 없이 **단 몇 초 만에 안정적으로 처리**합니다.
    * **비용 절감**: 운영 리소스를 획기적으로 절감하고, 사용자에게는 빠르고 정확한 보상 경험을 제공합니다.

---

### 4단계: Memo 필드 - 온체인에 기록되는 영구적인 '성취 증명'

환급금 지급 시, 사용자의 성취 기록을 블록체인에 영구적으로 남깁니다.

* **XRPL 상호작용**:
    1.  `sendBatchPayment` 메서드는 환급금 지급을 위한 `Payment` 트랜잭션 생성 시, **Memo 필드를 적극적으로 활용**합니다.
    2.  Memo에는 `{"type": "Challenge Refund", "message": "Challenge Refund"}`와 같이 트랜잭션의 목적과 내용을 명확히 하는 **JSON 형식의 데이터를 포함**시킵니다.

* **기술적 가치**:
    * **On-chain Proof**: 이 트랜잭션은 **XRPL 원장에 영구적으로 기록**되어, 해당 사용자가 챌린지를 성공적으로 완료하고 보상을 받았다는 사실을 누구나 검증할 수 있는 온체인 증거가 됩니다.
    * **데이터 확장성**: 단순 문자열을 넘어 구조화된 데이터를 Memo에 기록함으로써, 향후 이 온체인 데이터를 분석하여 사용자의 활동 이력을 추적하거나, **외부 서비스와 연동하여 디지털 자격증명(Credential)으로 활용**할 수 있는 기반을 마련했습니다.

---



